{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dennisdowner/Documents/GT_Bootcamp/21-MERN/Book-Search-Engine/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/dennisdowner/Documents/GT_Bootcamp/21-MERN/Book-Search-Engine/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/dennisdowner/Documents/GT_Bootcamp/21-MERN/Book-Search-Engine/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/dennisdowner/Documents/GT_Bootcamp/21-MERN/Book-Search-Engine/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{Jumbotron,Container,CardColumns,Card,Button}from'react-bootstrap';import{useQuery,useMutation}from'@apollo/client';import{GET_ME}from'../utils/queries';import{REMOVE_BOOK}from'../utils/mutations';import{removeBookId}from'../utils/localStorage';import Auth from\"../utils/auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SavedBooks=function SavedBooks(){var profileData=Auth.getProfile();var userId=profileData.data._id;console.log(userId);var userData=useQuery(GET_ME,{variables:{userId:userId}});console.log(userData);var data=userData.data||[];var spread=_objectSpread({},data.user);console.log(spread.username);var _useMutation=useMutation(REMOVE_BOOK),_useMutation2=_slicedToArray(_useMutation,2),removeBook=_useMutation2[0],error=_useMutation2[1].error;var handleDeleteBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(bookId){var token,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=Auth.loggedIn()?Auth.getToken():null;if(token){_context.next=3;break;}return _context.abrupt(\"return\",false);case 3:_context.prev=3;_context.next=6;return removeBook({variables:{userId:userId,bookId:bookId}});case 6:response=_context.sent;setUserState(_objectSpread({},response.data.removeBook));// update state\nremoveBookId(bookId);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](3);console.error(_context.t0);case 14:if(spread.username){_context.next=16;break;}return _context.abrupt(\"return\",/*#__PURE__*/_jsx(\"h2\",{children:\"LOADING...\"}));case 16:case\"end\":return _context.stop();}}},_callee,null,[[3,11]]);}));return function handleDeleteBook(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Jumbotron,{fluid:true,className:\"text-light bg-dark\",children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(\"h1\",{children:\"Viewing saved books!\"})})}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{children:userData.savedBooks.length?\"Viewing \".concat(userData.savedBooks.length,\" saved \").concat(userData.savedBooks.length===1?'book':'books',\":\"):'You have no saved books!'}),/*#__PURE__*/_jsx(CardColumns,{children:userData.savedBooks.map(function(book){return/*#__PURE__*/_jsxs(Card,{border:\"dark\",children:[book.image?/*#__PURE__*/_jsx(Card.Img,{src:book.image,alt:\"The cover for \".concat(book.title),variant:\"top\"}):null,/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"small\",children:[\"Authors: \",book.authors]}),/*#__PURE__*/_jsx(Card.Text,{children:book.description}),/*#__PURE__*/_jsx(Button,{className:\"btn-block btn-danger\",onClick:function onClick(){return handleDeleteBook(book.bookId);},children:\"Delete this Book!\"})]})]},book.bookId);})})]})]});};export default SavedBooks;","map":{"version":3,"names":["React","useState","Jumbotron","Container","CardColumns","Card","Button","useQuery","useMutation","GET_ME","REMOVE_BOOK","removeBookId","Auth","SavedBooks","profileData","getProfile","userId","data","_id","console","log","userData","variables","spread","user","username","removeBook","error","handleDeleteBook","bookId","token","loggedIn","getToken","response","setUserState","savedBooks","length","map","book","image","title","authors","description"],"sources":["/Users/dennisdowner/Documents/GT_Bootcamp/21-MERN/Book-Search-Engine/client/src/pages/SavedBooks.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Jumbotron, Container, CardColumns, Card, Button } from 'react-bootstrap';\nimport { useQuery, useMutation } from '@apollo/client';\nimport { GET_ME } from '../utils/queries';\nimport { REMOVE_BOOK } from '../utils/mutations';\nimport { removeBookId } from '../utils/localStorage';\nimport Auth from \"../utils/auth\";\n\nconst SavedBooks = () => {\n  const profileData = Auth.getProfile();\n  const userId = profileData.data._id;\n  console.log(userId);\n\n  const userData = useQuery(GET_ME, {variables: {userId: userId}});\n  console.log(userData);\n  const data = userData.data || [];\n  const spread = {...data.user};\n\n  console.log(spread.username);\n  const [removeBook, {error}] = useMutation(REMOVE_BOOK);\n\n  const handleDeleteBook =async (bookId) => {\n    const token = Auth.loggedIn() ? Auth.getToken() : null;\n\n    if (!token) {\n      return false;\n    }\n    \n    try {\n      const response = await removeBook({ variables: { userId: userId, bookId: bookId } });\n  \n    setUserState({ ...response.data.removeBook }); // update state\n    removeBookId(bookId);\n  } catch (err) {\n    console.error(err);\n  }\n\n  // if data isn't here yet, say so\n  if (!spread.username) {\n    return <h2>LOADING...</h2>;\n    }\n  }\n\n  return (\n    <>\n      <Jumbotron fluid className='text-light bg-dark'>\n        <Container>\n          <h1>Viewing saved books!</h1>\n        </Container>\n      </Jumbotron>\n      <Container>\n        <h2>\n          {userData.savedBooks.length\n            ? `Viewing ${userData.savedBooks.length} saved ${userData.savedBooks.length === 1 ? 'book' : 'books'}:`\n            : 'You have no saved books!'}\n        </h2>\n        <CardColumns>\n          {userData.savedBooks.map((book) => {\n            return (\n              <Card key={book.bookId} border='dark'>\n                {book.image ? <Card.Img src={book.image} alt={`The cover for ${book.title}`} variant='top' /> : null}\n                <Card.Body>\n                  <Card.Title>{book.title}</Card.Title>\n                  <p className='small'>Authors: {book.authors}</p>\n                  <Card.Text>{book.description}</Card.Text>\n                  <Button className='btn-block btn-danger' onClick={() => handleDeleteBook(book.bookId)}>\n                    Delete this Book!\n                  </Button>\n                </Card.Body>\n              </Card>\n            );\n          })}\n        </CardColumns>\n      </Container>\n    </>\n  );\n};\n\nexport default SavedBooks;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}